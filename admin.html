<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Admin FE - Gesti√≥n de Art√≠culos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script>
        const AUTH_KEY = "efectiva_admin_auth";
        if (localStorage.getItem(AUTH_KEY) !== "1") {
            window.location.href = "login.html";
        }
    </script>

    <!-- ========== ESTILOS ========== -->
    <style>
        :root {
            --bg: #f5f7fa;
            --text: #111827;
            --card: #ffffff;
            --accent: #0f4c81;
            --accent-soft: #2563eb;
            --border: #e5e7eb;
            --shadow: 0 4px 12px rgba(15, 23, 42, 0.08);
            --danger: #dc2626;
            --muted: #6b7280;
        }

        body.dark {
            --bg: #020617;
            --text: #e5e7eb;
            --card: #020617;
            --accent: #38bdf8;
            --accent-soft: #0ea5e9;
            --border: #1f2937;
            --shadow: 0 14px 40px rgba(0, 0, 0, 0.75);
            --danger: #f97373;
            --muted: #9ca3af;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0
        }

        body {
            font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        header {
            background: var(--card);
            border-bottom: 1px solid var(--border);
            box-shadow: var(--shadow);
            padding: 14px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 20;
        }

        .header-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-sub {
            font-size: 12px;
            color: var(--muted);
        }

        .pill {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 999px;
            border: 1px solid var(--border);
        }

        .btn-toggle {
            border: none;
            border-radius: 999px;
            padding: 8px 14px;
            font-size: 13px;
            cursor: pointer;
            background: var(--accent);
            color: #f9fafb;
        }

        .container {
            max-width: 1160px;
            margin: 0 auto;
            padding: 18px 16px 28px;
        }

        /* PANEL SUPERIOR */
        .top-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .search-input {
            width: 260px;
            max-width: 100%;
            padding: 9px 11px;
            border-radius: 999px;
            border: 1px solid var(--border);
            background: var(--card);
            color: var(--text);
            font-size: 13px;
        }

        .btn {
            border: none;
            border-radius: 999px;
            padding: 8px 14px;
            font-size: 13px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: var(--accent-soft);
            color: #f9fafb;
            box-shadow: 0 0 0 rgba(0, 0, 0, 0);
            transition: .15s;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 20px rgba(15, 23, 42, 0.25);
        }

        .btn-danger {
            background: var(--danger);
            color: #fee2e2;
        }

        .badge {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid var(--border);
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .badge-dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: #10b981;
        }

        .badge-danger .badge-dot {
            background: var(--danger);
        }

        .metrics-row {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 8px;
        }

        .metrics-cats {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 10px;
        }

        .cat-pill {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.6);
            background: rgba(148, 163, 184, 0.08);
        }

        /* TARJETA */
        .card {
            background: var(--card);
            border-radius: 14px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            padding: 16px 16px 18px;
            margin-bottom: 16px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .card-title {
            font-size: 15px;
            font-weight: 600;
        }

        .card-sub {
            font-size: 12px;
            color: var(--muted);
        }

        /* TABLA */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        th,
        td {
            padding: 8px 8px;
            border-bottom: 1px solid var(--border);
            text-align: left;
        }

        th {
            font-weight: 600;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: .05em;
            color: var(--muted);
        }

        tr:hover td {
            background: rgba(148, 163, 184, 0.08);
        }

        .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .btn-xs {
            padding: 4px 8px;
            font-size: 11px;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            background: rgba(148, 163, 184, 0.18);
            color: var(--text);
        }

        .btn-xs.primary {
            background: rgba(56, 189, 248, 0.15);
        }

        .btn-xs.danger {
            background: rgba(248, 113, 113, 0.16);
            color: #fecaca;
        }

        /* FORMULARIO */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
            gap: 10px 14px;
            margin-top: 6px;
        }

        label {
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 4px;
            display: block;
        }

        input,
        select {
            width: 100%;
            padding: 8px 9px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--text);
            font-size: 13px;
            outline: none;
        }

        input:focus,
        select:focus {
            border-color: var(--accent-soft);
            box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.35);
            background: var(--card);
        }

        #editor {
            background: var(--card);
            border-radius: 8px;
            border: 1px solid var(--border);
            height: 220px;
            margin-top: 6px;
        }

        .form-actions {
            margin-top: 14px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* MODAL PREVIEW */
        #modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(3px);
            padding: 40px 18px;
            overflow-y: auto;
            z-index: 40;
        }

        .modal-inner {
            max-width: 860px;
            margin: 0 auto;
            background: var(--card);
            border-radius: 14px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            padding: 22px 20px 26px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 10px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-meta {
            font-size: 12px;
            color: var(--muted);
        }

        .btn-close {
            border: none;
            padding: 6px 10px;
            border-radius: 999px;
            font-size: 12px;
            cursor: pointer;
            background: rgba(15, 23, 42, 0.1);
            color: var(--text);
        }

        .modal-body {
            font-size: 13px;
            margin-top: 6px;
        }

        .copy-btn {
            border: none;
            padding: 6px 12px;
            border-radius: 999px;
            font-size: 12px;
            cursor: pointer;
            background: rgba(56, 189, 248, 0.15);
            margin-top: 4px;
        }

        /* OVERLAY CARGA */
        #loadingOverlay {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.65);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 60;
            color: #e5e7eb;
            font-size: 14px;
            flex-direction: column;
            gap: 10px;
        }

        .loader-bar {
            width: 180px;
            height: 4px;
            border-radius: 999px;
            background: rgba(148, 163, 184, 0.4);
            overflow: hidden;
        }

        .loader-bar-inner {
            width: 40%;
            height: 100%;
            border-radius: 999px;
            background: #38bdf8;
            animation: loading 1s infinite;
        }

        @keyframes loading {
            0% {
                transform: translateX(-100%);
            }

            50% {
                transform: translateX(50%);
            }

            100% {
                transform: translateX(200%);
            }
        }

        @media(max-width:720px) {
            header {
                flex-direction: column;
                align-items: flex-start;
                gap: 6px;
            }

            .top-bar {
                flex-direction: column;
                align-items: flex-start;
            }

            .search-input {
                width: 100%
            }
        }
    </style>
    <!-- QUILL -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
</head>

<body>
    <header>
        <div>
            <div class="header-title">
                üõ†Ô∏è Admin FE ‚Äì Base de Conocimiento
                <span class="pill">Panel interno</span>
            </div>
            <div class="header-sub">Crear, editar, destacar y medir tus art√≠culos.</div>
        </div>
        <button id="themeToggle" class="btn-toggle">Modo oscuro</button>
    </header>
    <div class="container">
        <!-- PANEL LISTADO + DASHBOARD -->
        <section class="card">
            <div class="card-header">
                <div>
                    <div class="card-title">Art√≠culos registrados</div>
                    <div class="card-sub">Dashboard + listado de contenidos.</div>
                </div>
                <button class="btn" id="btnNuevo">‚ûï Nuevo art√≠culo</button>
            </div>
            <div class="top-bar">
                <input id="searchTabla" class="search-input" placeholder="Filtrar por t√≠tulo, categor√≠a o resumen‚Ä¶" />
            </div>
            <!-- DASHBOARD M√âTRICAS -->
            <div class="metrics-row">
                <div class="badge">
                    <span class="badge-dot"></span>
                    <span id="contadorArticulos">0 art√≠culos</span>
                </div>
                <div class="badge">
                    <span class="badge-dot"></span>
                    <span id="contadorVisibles">0 visibles</span>
                </div>
                <div class="badge badge-danger">
                    <span class="badge-dot"></span>
                    <span id="contadorDestacados">0 destacados</span>
                </div>
            </div>
            <div id="metricsCategorias" class="metrics-cats"></div>
            <div style="overflow-x:auto;">
                <table>
                    <thead>
                        <tr>
                            <th>T√≠tulo</th>
                            <th>Categor√≠a</th>
                            <th>Visible</th>
                            <th>Destacado</th>
                            <th>Fecha</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="tablaArticulos"></tbody>
                </table>
            </div>
        </section>
        <!-- PANEL FORMULARIO -->
        <section class="card">
            <div class="card-header">
                <div>
                    <div class="card-title" id="formTitle">Nuevo art√≠culo</div>
                    <div class="card-sub">Completa la informaci√≥n y guarda para publicarlo.</div>
                </div>
            </div>
            <input type="hidden" id="articuloId">
            <div class="form-grid">
                <div>
                    <label>T√≠tulo</label>
                    <input id="titulo" placeholder="Ej. Plazo SBS para desembolso">
                </div>
                <div>
                    <label>Categor√≠a</label>
                    <select id="categoria">
                        <option value="">Seleccione</option>
                        <option>Norma Regulatoria</option>
                        <option>Monitoreo de Calidad</option>
                        <option>Speech</option>
                        <option>Flujos</option>
                        <option>Productos</option>
                        <option>General</option>
                    </select>
                </div>
                <div>
                    <label>Visible para agentes</label>
                    <select id="visibleAgentes">
                        <option value="true">S√≠</option>
                        <option value="false">No</option>
                    </select>
                </div>
                <div>
                    <label>Destacado</label>
                    <select id="destacado">
                        <option value="false">No</option>
                        <option value="true">S√≠</option>
                    </select>
                </div>
            </div>
            <div style="margin-top:10px;">
                <label>Resumen</label>
                <input id="resumen" placeholder="Breve descripci√≥n para el listado">
            </div>
            <div style="margin-top:10px;">
                <label>Contenido (HTML con formato)</label>
                <div id="editor"></div>
                <input type="hidden" id="contenido">
            </div>
            <div class="form-actions">
                <button class="btn" id="btnGuardar">üíæ Guardar art√≠culo</button>
                <button class="btn btn-danger" id="btnLimpiar">Limpiar</button>
            </div>
        </section>
    </div>
    <!-- MODAL PREVIEW -->
    <div id="modal">
        <div class="modal-inner">
            <div class="modal-header">
                <div>
                    <div class="modal-title" id="modalTitle"></div>
                    <div class="modal-meta" id="modalMeta"></div>
                </div>
                <button class="btn-close" id="btnCerrarModal">Cerrar</button>
            </div>
            <button class="copy-btn" id="btnCopiar">Copiar contenido</button>
            <div class="modal-body" id="modalContent"></div>
        </div>
    </div>
    <!-- OVERLAY CARGA -->
    <div id="loadingOverlay">
        <div id="loadingText">Procesando‚Ä¶</div>
        <div class="loader-bar">
            <div class="loader-bar-inner"></div>
        </div>
    </div>
    <!-- QUILL -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <!-- ========== FIREBASE + L√ìGICA ========== -->
    <script type="module">
        import {
            initializeApp
        } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import {
            getFirestore,
            collection,
            getDocs,
            addDoc,
            doc,
            getDoc,
            updateDoc,
            deleteDoc
        } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

        /* ======================================
           üîê LOGIN LOCAL: USER + PASSWORD
        ====================================== */
        const ADMIN_USER = "Efectiv-Wiki";
        const ADMIN_PASS = "Miwiki.efectiv-2025*";
        const AUTH_FLAG = "fe_admin_auth_ok_v2";

        function bloquearAcceso(mensaje) {
            document.body.innerHTML = `
      <div style="
        display:flex;
        align-items:center;
        justify-content:center;
        height:100vh;
        font-family:system-ui;
        color:#ef4444;
        font-size:18px;
        text-align:center;
        padding:20px;
      ">
        ‚ùå ${mensaje}
      </div>
    `;
        }

        if (localStorage.getItem(AUTH_FLAG) !== "1") {
            const u = prompt("Usuario administrador:");
            const p = prompt("Contrase√±a administrador:");
            if (u !== ADMIN_USER || p !== ADMIN_PASS) {
                alert("Credenciales incorrectas.");
                bloquearAcceso("Acceso no autorizado");
                throw new Error("No autorizado");
            }
            localStorage.setItem(AUTH_FLAG, "1");
        }

        /* ---- FIREBASE CONFIG ---- */
        const firebaseConfig = {
            apiKey: "AIzaSyBL1qT2tLfFTJ_f_3apv_sxKnn28u0nccs",
            authDomain: "financiera-efectiva-kb.firebaseapp.com",
            projectId: "financiera-efectiva-kb",
            storageBucket: "financiera-efectiva-kb.firebasestorage.app",
            messagingSenderId: "508397908196",
            appId: "1:508397908196:web:31d28a73ef56160963fcf1"
        };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const colArticulos = collection(db, "articulos");

        /* ---- QUILL ---- */
        const quill = new Quill("#editor", {
            theme: "snow",
            placeholder: "Escribe aqu√≠ el contenido completo del art√≠culo‚Ä¶"
        });

        /* ---- ESTADO ---- */
        let articulosCache = [];

        /* ---- OVERLAY CARGA ---- */
        function setLoading(show, text = "Procesando‚Ä¶") {
            const overlay = document.getElementById("loadingOverlay");
            const label = document.getElementById("loadingText");
            label.textContent = text;
            overlay.style.display = show ? "flex" : "none";
        }

        /* =======================
           CARGAR TABLA
        ======================= */
        async function cargarTabla() {
            const tbody = document.getElementById("tablaArticulos");
            try {
                setLoading(true, "Cargando art√≠culos‚Ä¶");
                tbody.innerHTML = "<tr><td colspan='6'>Cargando...</td></tr>";
                const snap = await getDocs(colArticulos);
                articulosCache = snap.docs.map(d => ({
                    id: d.id,
                    ...d.data()
                }));
                // ordenar por fecha (m√°s recientes primero)
                articulosCache.sort((a, b) => {
                    const fa = a.fecha ? new Date(a.fecha.toDate ? a.fecha.toDate() : a.fecha) : 0;
                    const fb = b.fecha ? new Date(b.fecha.toDate ? b.fecha.toDate() : b.fecha) : 0;
                    return fb - fa;
                });
                renderTabla(articulosCache);
            } catch (e) {
                console.error(e);
                alert("Error cargando art√≠culos: " + e.message);
            } finally {
                setLoading(false);
            }
        }

        function actualizarDashboard(lista) {
            const total = lista.length;
            const visibles = lista.filter(a => a.visibleAgentes).length;
            const destacados = lista.filter(a => a.destacado).length;

            document.getElementById("contadorArticulos").textContent = total + " art√≠culos";
            document.getElementById("contadorVisibles").textContent = visibles + " visibles";
            document.getElementById("contadorDestacados").textContent = destacados + " destacados";

            const cats = {};
            lista.forEach(a => {
                const c = a.categoria || "Sin categor√≠a";
                cats[c] = (cats[c] || 0) + 1;
            });
            const cont = document.getElementById("metricsCategorias");
            cont.innerHTML = Object.keys(cats).map(c =>
                `<span class="cat-pill">${c}: ${cats[c]}</span>`
            ).join("");
        }

        function renderTabla(lista) {
            const tbody = document.getElementById("tablaArticulos");
            actualizarDashboard(lista);
            if (!lista.length) {
                tbody.innerHTML = "<tr><td colspan='6'>Sin art√≠culos registrados a√∫n.</td></tr>";
                return;
            }
            tbody.innerHTML = lista.map(a => {
                const fechaStr = a.fecha ?
                    new Date(a.fecha.toDate ? a.fecha.toDate() : a.fecha).toLocaleDateString("es-PE") :
                    "-";
                return `
        <tr>
            <td>${a.titulo || ""}</td>
            <td>${a.categoria || ""}</td>
            <td>${a.visibleAgentes ? "S√≠" : "No"}</td>
            <td>${a.destacado ? "‚≠ê" : "‚Äî"}</td>
            <td>${fechaStr}</td>
            <td>
                <div class="actions">
                    <button class="btn-xs" onclick="verArticulo('${a.id}')">Ver</button>
                    <button class="btn-xs primary" onclick="editar('${a.id}')">Editar</button>
                    <button class="btn-xs danger" onclick="eliminar('${a.id}')">Eliminar</button>
                </div>
            </td>
        </tr>`;
            }).join("");
        }

        /* =======================
           BUSCAR EN TABLA
        ======================= */
        document.getElementById("searchTabla").addEventListener("input", e => {
            const q = e.target.value.trim().toLowerCase();
            if (!q) {
                renderTabla(articulosCache);
                return;
            }
            const filtrados = articulosCache.filter(a => {
                const t = (a.titulo || "").toLowerCase();
                const r = (a.resumen || "").toLowerCase();
                const c = (a.categoria || "").toLowerCase();
                return t.includes(q) || r.includes(q) || c.includes(q);
            });
            renderTabla(filtrados);
        });

        /* =======================
           LIMPIAR FORM
        ======================= */
        function limpiarFormulario() {
            document.getElementById("articuloId").value = "";
            document.getElementById("titulo").value = "";
            document.getElementById("categoria").value = "";
            document.getElementById("resumen").value = "";
            document.getElementById("visibleAgentes").value = "true";
            document.getElementById("destacado").value = "false";
            quill.root.innerHTML = "";
            document.getElementById("formTitle").textContent = "Nuevo art√≠culo";
        }

        /* =======================
           GUARDAR
        ======================= */
        async function guardarArticulo() {
            const id = document.getElementById("articuloId").value;
            const data = {
                titulo: document.getElementById("titulo").value.trim(),
                categoria: document.getElementById("categoria").value,
                resumen: document.getElementById("resumen").value.trim(),
                contenido: quill.root.innerHTML,
                visibleAgentes: document.getElementById("visibleAgentes").value === "true",
                destacado: document.getElementById("destacado").value === "true",
                fecha: new Date()
            };
            if (!data.titulo || !data.categoria || !data.resumen) {
                alert("Completa t√≠tulo, categor√≠a y resumen.");
                return;
            }
            try {
                setLoading(true, id ? "Actualizando art√≠culo‚Ä¶" : "Guardando art√≠culo‚Ä¶");
                if (id) {
                    await updateDoc(doc(db, "articulos", id), data);
                    alert("Art√≠culo actualizado.");
                } else {
                    await addDoc(colArticulos, data);
                    alert("Art√≠culo creado.");
                }
                limpiarFormulario();
                await cargarTabla();
            } catch (e) {
                console.error(e);
                alert("Error al guardar: " + e.message);
            } finally {
                setLoading(false);
            }
        }

        /* =======================
           EDITAR
        ======================= */
        window.editar = async function(id) {
            try {
                setLoading(true, "Cargando art√≠culo para edici√≥n‚Ä¶");
                const ref = doc(db, "articulos", id);
                const s = await getDoc(ref);
                if (!s.exists()) {
                    alert("No se encontr√≥ el art√≠culo");
                    return;
                }
                const a = s.data();
                document.getElementById("articuloId").value = id;
                document.getElementById("titulo").value = a.titulo || "";
                document.getElementById("categoria").value = a.categoria || "";
                document.getElementById("resumen").value = a.resumen || "";
                document.getElementById("visibleAgentes").value = a.visibleAgentes ? "true" : "false";
                document.getElementById("destacado").value = a.destacado ? "true" : "false";
                quill.root.innerHTML = a.contenido || "";
                document.getElementById("formTitle").textContent = "Editar art√≠culo";
                window.scrollTo({
                    top: document.body.scrollHeight,
                    behavior: "smooth"
                });
            } catch (e) {
                console.error(e);
                alert("Error al cargar para editar: " + e.message);
            } finally {
                setLoading(false);
            }
        };

        /* =======================
           ELIMINAR
        ======================= */
        window.eliminar = async function(id) {
            if (!confirm("¬øEliminar este art√≠culo?")) return;
            try {
                setLoading(true, "Eliminando art√≠culo‚Ä¶");
                await deleteDoc(doc(db, "articulos", id));
                alert("Art√≠culo eliminado.");
                await cargarTabla();
            } catch (e) {
                console.error(e);
                alert("Error al eliminar: " + e.message);
            } finally {
                setLoading(false);
            }
        };

        /* =======================
           VER / PREVIEW
        ======================= */
        window.verArticulo = function(id) {
            const a = articulosCache.find(x => x.id === id);
            if (!a) return;
            document.getElementById("modalTitle").textContent = a.titulo || "";
            const fechaStr = a.fecha ?
                new Date(a.fecha.toDate ? a.fecha.toDate() : a.fecha).toLocaleString("es-PE") :
                "";
            document.getElementById("modalMeta").textContent =
                (a.categoria || "") + (fechaStr ? " ¬∑ " + fechaStr : "");
            document.getElementById("modalContent").innerHTML = a.contenido || "";
            document.getElementById("modal").style.display = "block";
            document.getElementById("btnCopiar").onclick = async () => {
                const tmp = document.createElement("div");
                tmp.innerHTML = a.contenido || "";
                const textoPlano = tmp.innerText;
                await navigator.clipboard.writeText(textoPlano);
                alert("Contenido copiado al portapapeles.");
            };
        };
        document.getElementById("btnCerrarModal").onclick = () => {
            document.getElementById("modal").style.display = "none";
        };

        /* =======================
           BOTONES
        ======================= */
        document.getElementById("btnGuardar").onclick = guardarArticulo;
        document.getElementById("btnLimpiar").onclick = limpiarFormulario;
        document.getElementById("btnNuevo").onclick = limpiarFormulario;

        /* =======================
           MODO OSCURO / CLARO
        ======================= */
        const themeBtn = document.getElementById("themeToggle");

        function applyTheme(theme) {
            if (theme === "dark") {
                document.body.classList.add("dark");
                themeBtn.textContent = "Modo claro";
            } else {
                document.body.classList.remove("dark");
                themeBtn.textContent = "Modo oscuro";
            }
        }
        const savedTheme = localStorage.getItem("fe_admin_theme") || "light";
        applyTheme(savedTheme);
        themeBtn.onclick = () => {
            const next = document.body.classList.contains("dark") ? "light" : "dark";
            localStorage.setItem("fe_admin_theme", next);
            applyTheme(next);
        };

        /* Inicial */
        cargarTabla();
    </script>
</body>

</html>
